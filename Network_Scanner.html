
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module Network_Scanner</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>Network_Scanner</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/home/isaidnocookies/Documents/Development/NetworkScanner/Network_Scanner.py">/home/isaidnocookies/Documents/Development/NetworkScanner/Network_Scanner.py</a></font></td></tr></table>
    <p></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="xml.etree.ElementTree.html">xml.etree.ElementTree</a><br>
<a href="argparse.html">argparse</a><br>
<a href="datetime.html">datetime</a><br>
<a href="json.html">json</a><br>
</td><td width="25%" valign=top><a href="logging.html">logging</a><br>
<a href="os.html">os</a><br>
<a href="pickle.html">pickle</a><br>
<a href="signal.html">signal</a><br>
</td><td width="25%" valign=top><a href="sqlite3.html">sqlite3</a><br>
<a href="subprocess.html">subprocess</a><br>
<a href="sys.html">sys</a><br>
<a href="time.html">time</a><br>
</td><td width="25%" valign=top><a href="xmltodict.html">xmltodict</a><br>
</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ee77aa">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font></td></tr>
    
<tr><td bgcolor="#ee77aa"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl>
<dt><font face="helvetica, arial"><a href="Network_Scanner.html#Network_Scanner">Network_Scanner</a>
</font></dt></dl>
 <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="Network_Scanner">class <strong>Network_Scanner</strong></a></font></td></tr>
    
<tr><td bgcolor="#ffc8d8"><tt>&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="Network_Scanner-__del__"><strong>__del__</strong></a>(self)</dt><dd><tt>Destructor:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Attempts&nbsp;to&nbsp;close&nbsp;database&nbsp;connection&nbsp;when&nbsp;instance&nbsp;is&nbsp;destroyed.</tt></dd></dl>

<dl><dt><a name="Network_Scanner-__init__"><strong>__init__</strong></a>(self)</dt><dd><tt>Constructor:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Establishes&nbsp;timestamp&nbsp;for&nbsp;instance,&nbsp;logging,&nbsp;and&nbsp;initializing&nbsp;some&nbsp;instance&nbsp;variables.</tt></dd></dl>

<dl><dt><a name="Network_Scanner-getConfig"><strong>getConfig</strong></a>(self)</dt><dd><tt>Returns&nbsp;the&nbsp;configuration&nbsp;object.&nbsp;REQUIRES&nbsp;loadConfig&nbsp;to&nbsp;be&nbsp;called<br>
on&nbsp;the&nbsp;object&nbsp;for&nbsp;initialization.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;-&nbsp;{}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;configuration&nbsp;object&nbsp;from&nbsp;the&nbsp;class&nbsp;instance.</tt></dd></dl>

<dl><dt><a name="Network_Scanner-getTargetFiles"><strong>getTargetFiles</strong></a>(self)</dt><dd><tt>Returns&nbsp;the&nbsp;target&nbsp;filenames.&nbsp;REQUIRES&nbsp;loadTargetFiles&nbsp;to&nbsp;be&nbsp;called<br>
on&nbsp;the&nbsp;object&nbsp;for&nbsp;initialization.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Array&nbsp;of&nbsp;strings&nbsp;-&nbsp;[strings]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;an&nbsp;array&nbsp;of&nbsp;strings&nbsp;representing&nbsp;all&nbsp;of&nbsp;the&nbsp;target&nbsp;lists</tt></dd></dl>

<dl><dt><a name="Network_Scanner-initializeSqlite"><strong>initializeSqlite</strong></a>(self, filename<font color="#909090">=''</font>)</dt><dd><tt>Initializes&nbsp;the&nbsp;SQLite&nbsp;database.&nbsp;This&nbsp;function&nbsp;connects&nbsp;to&nbsp;/&nbsp;creates&nbsp;the&nbsp;sqlite&nbsp;database&nbsp;file&nbsp;and&nbsp;creates<br>
the&nbsp;status&nbsp;table&nbsp;that&nbsp;holds&nbsp;the&nbsp;associated&nbsp;scans<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Filname&nbsp;:&nbsp;string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename&nbsp;associated&nbsp;with&nbsp;the&nbsp;sqlite&nbsp;database.&nbsp;If&nbsp;this&nbsp;does&nbsp;not&nbsp;exist,&nbsp;the&nbsp;db&nbsp;will&nbsp;be&nbsp;created.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Boolean<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;if&nbsp;the&nbsp;function&nbsp;was&nbsp;success&nbsp;in&nbsp;pulling&nbsp;the&nbsp;files&nbsp;from&nbsp;the&nbsp;target_directory</tt></dd></dl>

<dl><dt><a name="Network_Scanner-initializeSqliteScanData"><strong>initializeSqliteScanData</strong></a>(self)</dt><dd><tt>Initializes&nbsp;the&nbsp;database&nbsp;and&nbsp;populates&nbsp;the&nbsp;scans&nbsp;table&nbsp;with&nbsp;data&nbsp;from&nbsp;the&nbsp;target_directory.<br>
NOTE&nbsp;-&nbsp;This&nbsp;will&nbsp;drop&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;existing&nbsp;scans&nbsp;table<br>
This&nbsp;function&nbsp;generates&nbsp;the&nbsp;scans&nbsp;table&nbsp;-&nbsp;(target_file,&nbsp;status,&nbsp;start_timestamp,&nbsp;end_timestamp)<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A</tt></dd></dl>

<dl><dt><a name="Network_Scanner-loadConfig"><strong>loadConfig</strong></a>(self, filename<font color="#909090">='./config.json'</font>)</dt><dd><tt>Sets&nbsp;the&nbsp;configuration&nbsp;within&nbsp;the&nbsp;class&nbsp;instance.<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;:&nbsp;string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename&nbsp;of&nbsp;the&nbsp;configuration&nbsp;(json)&nbsp;file.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;to&nbsp;config.json&nbsp;in&nbsp;the&nbsp;scripts&nbsp;root&nbsp;directory<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A</tt></dd></dl>

<dl><dt><a name="Network_Scanner-loadTargetFiles"><strong>loadTargetFiles</strong></a>(self)</dt><dd><tt>Loads&nbsp;files&nbsp;from&nbsp;the&nbsp;target&nbsp;directory&nbsp;specified&nbsp;in&nbsp;the&nbsp;configuration&nbsp;file.&nbsp;This&nbsp;will&nbsp;set&nbsp;the&nbsp;input&nbsp;files<br>
to&nbsp;the&nbsp;targetFiles&nbsp;variable&nbsp;(array&nbsp;of&nbsp;strings)&nbsp;within&nbsp;the&nbsp;instance.<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Boolean<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;if&nbsp;the&nbsp;function&nbsp;was&nbsp;success&nbsp;in&nbsp;pulling&nbsp;the&nbsp;files&nbsp;from&nbsp;the&nbsp;target_directory</tt></dd></dl>

<dl><dt><a name="Network_Scanner-nmapScan"><strong>nmapScan</strong></a>(self, target_file)</dt><dd><tt>Runs&nbsp;an&nbsp;nmap&nbsp;scan&nbsp;with&nbsp;the&nbsp;-sT,&nbsp;-Pn&nbsp;flags&nbsp;on&nbsp;the&nbsp;ip&nbsp;addresses&nbsp;included&nbsp;in&nbsp;the&nbsp;specified&nbsp;target&nbsp;file.<br>
The&nbsp;results&nbsp;are&nbsp;parsed&nbsp;from&nbsp;xml&nbsp;to&nbsp;a&nbsp;json&nbsp;object&nbsp;for&nbsp;later&nbsp;manipulation&nbsp;and&nbsp;storage.<br>
Nmap&nbsp;scans&nbsp;on&nbsp;the&nbsp;ports&nbsp;specified&nbsp;in&nbsp;the&nbsp;configuration&nbsp;file.<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;target_file&nbsp;:&nbsp;string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filename&nbsp;of&nbsp;the&nbsp;target&nbsp;file.&nbsp;Ip&nbsp;addresses&nbsp;/&nbsp;networks&nbsp;are&nbsp;pulled&nbsp;from&nbsp;this&nbsp;file.&nbsp;Any&nbsp;format<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compatible&nbsp;with&nbsp;nmap&nbsp;input&nbsp;lists&nbsp;can&nbsp;be&nbsp;used<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;-&nbsp;json<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nmap&nbsp;data&nbsp;that&nbsp;has&nbsp;been&nbsp;converted&nbsp;from&nbsp;the&nbsp;XML&nbsp;dat</tt></dd></dl>

<dl><dt><a name="Network_Scanner-saveDataInDatabase"><strong>saveDataInDatabase</strong></a>(self, targetFilename, scanData)</dt><dd><tt>Saves&nbsp;data&nbsp;to&nbsp;the&nbsp;database&nbsp;in&nbsp;the&nbsp;appropiate&nbsp;table.&nbsp;Each&nbsp;table&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;individual&nbsp;scan.<br>
DB&nbsp;Schema&nbsp;-&nbsp;(ip_address&nbsp;TEXT,&nbsp;hostname&nbsp;TEXT,&nbsp;port&nbsp;TEXT,&nbsp;protocol&nbsp;TEXT,&nbsp;service&nbsp;TEXT,&nbsp;state&nbsp;TEXT)<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;targetFilename&nbsp;:&nbsp;string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;filename&nbsp;associated&nbsp;with&nbsp;the&nbsp;completed&nbsp;scan.&nbsp;This&nbsp;will&nbsp;become&nbsp;the&nbsp;scan's&nbsp;table&nbsp;name<br>
&nbsp;&nbsp;&nbsp;&nbsp;scanData&nbsp;:&nbsp;Object<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;data&nbsp;associated&nbsp;with&nbsp;the&nbsp;completed&nbsp;nmap&nbsp;scan.&nbsp;This&nbsp;will&nbsp;be&nbsp;in&nbsp;JSON&nbsp;/&nbsp;Object&nbsp;format&nbsp;from&nbsp;the&nbsp;XML&nbsp;parsing<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A</tt></dd></dl>

<dl><dt><a name="Network_Scanner-scanFromDB"><strong>scanFromDB</strong></a>(self)</dt><dd><tt>Runs&nbsp;nmap&nbsp;scans&nbsp;from&nbsp;pending&nbsp;entries&nbsp;in&nbsp;the&nbsp;database.&nbsp;This&nbsp;function&nbsp;will&nbsp;loop&nbsp;through&nbsp;the&nbsp;database&nbsp;scan&nbsp;entries<br>
and&nbsp;run&nbsp;scans&nbsp;associated&nbsp;with&nbsp;pending&nbsp;target&nbsp;lists.&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;In&nbsp;Progress&nbsp;scan,&nbsp;it&nbsp;will&nbsp;not&nbsp;resume&nbsp;it&nbsp;--&nbsp;yet<br>
&nbsp;<br>
This&nbsp;function&nbsp;will&nbsp;also&nbsp;dump&nbsp;scan&nbsp;data&nbsp;into&nbsp;a&nbsp;temp&nbsp;directory.&nbsp;Each&nbsp;scan&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;an&nbsp;output&nbsp;dump&nbsp;(in<br>
the&nbsp;Object&nbsp;format)&nbsp;in&nbsp;the&nbsp;specified&nbsp;folder.<br>
&nbsp;<br>
This&nbsp;function&nbsp;calls&nbsp;the&nbsp;saveDataInDatabase&nbsp;function&nbsp;and&nbsp;will&nbsp;initialize&nbsp;the&nbsp;Sqlite&nbsp;database&nbsp;if&nbsp;the&nbsp;dbInit&nbsp;variable<br>
has&nbsp;not&nbsp;been&nbsp;set.<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A</tt></dd></dl>

<hr>
Static methods defined here:<br>
<dl><dt><a name="Network_Scanner-checkIfFileExists"><strong>checkIfFileExists</strong></a>(filename)</dt><dd><tt>Simple&nbsp;function&nbsp;to&nbsp;check&nbsp;if&nbsp;a&nbsp;file&nbsp;exists<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;:&nbsp;string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;to&nbsp;be&nbsp;checked<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Boolean<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Whether&nbsp;or&nbsp;not&nbsp;the&nbsp;file&nbsp;exists</tt></dd></dl>

<dl><dt><a name="Network_Scanner-getTimeStamp"><strong>getTimeStamp</strong></a>(iIncludeTime<font color="#909090">=True</font>)</dt><dd><tt>Simple&nbsp;function&nbsp;to&nbsp;generate&nbsp;a&nbsp;timestamp<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;iIncludeTime&nbsp;:&nbsp;Boolean<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Whether&nbsp;or&nbsp;not&nbsp;the&nbsp;time&nbsp;is&nbsp;included&nbsp;with&nbsp;the&nbsp;date&nbsp;timestamp<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;String<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Formatted&nbsp;timestamp</tt></dd></dl>

<dl><dt><a name="Network_Scanner-parseNmapXml"><strong>parseNmapXml</strong></a>(xmlData)</dt><dd><tt>Parses&nbsp;the&nbsp;XML&nbsp;data&nbsp;exported&nbsp;from&nbsp;the&nbsp;nmap&nbsp;scan.&nbsp;This&nbsp;function&nbsp;converts&nbsp;the&nbsp;xml&nbsp;document&nbsp;to<br>
an&nbsp;object&nbsp;to&nbsp;be&nbsp;parsed&nbsp;and&nbsp;saved&nbsp;to&nbsp;the&nbsp;database<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;xmlData&nbsp;:&nbsp;String<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;dump&nbsp;of&nbsp;the&nbsp;xml&nbsp;output&nbsp;from&nbsp;nmap<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;-&nbsp;JSON<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;from&nbsp;the&nbsp;xml&nbsp;document</tt></dd></dl>

</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-exitApplication"><strong>exitApplication</strong></a>(sig_num, frame)</dt><dd><tt>Catches&nbsp;SIGINT&nbsp;in&nbsp;order&nbsp;to&nbsp;provide&nbsp;a&nbsp;place&nbsp;for&nbsp;graceful&nbsp;terminations&nbsp;during&nbsp;scans.<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;sign_num&nbsp;:&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signal&nbsp;integer<br>
&nbsp;&nbsp;&nbsp;&nbsp;frame&nbsp;:&nbsp;Object<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Current&nbsp;stack&nbsp;frame<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;N/A</tt></dd></dl>
</td></tr></table>
</body></html>